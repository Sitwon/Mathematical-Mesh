<?xml version='1.0'?>
<!DOCTYPE rfc SYSTEM 'rfc2629.dtd'>
<rfc ipr="trust200902" docName="draft-hallambaker-sin-00" category="info">
<?rfc toc="yes"?>  
<?rfc symrefs="yes"?>  
<?rfc sortrefs="yes"?>  
<?rfc compact="yes"?>  
<?rfc subcompact="no"?>  
<front>
<title abbrev="Strong Internet Names (SIN)">Strong Internet Names (SIN)</title>
<author fullname="Phillip Hallam-Baker" initials="P. M." surname="Hallam-Baker">
<organization>Comodo Group Inc.</organization>
<address>
<email>philliph@comodo.com</email>
</address>
</author>
<date day="29" month="June" year="2017"/>
<area>sec</area>
<workgroup/>
<keyword>Cryptography</keyword>
<keyword>UDF</keyword>
<keyword>Identifiers</keyword>
<abstract>
<t>A Strong Internet Name is a DNS name that contains a cryptographic binding to a security policy governing interpretation of the name. This document describes the use of Strong Internet Names formed using a Uniform Data Fingerprint of a PKIX trust root and outlines the additional capabilities that might be supported in a purpose written policy language.</t>
</abstract>
</front>
<middle>
<section title="Introduction" anchor="Section_1">
<t>This document is written as a submission to the IAB workshop on Explicit Internet Naming Systems. The proposal described here is a mechanism that allows a security policy and cryptographic root of trust to be introduced into any Internet identifier scheme that includes a DNS name without introducing new syntax.</t>
<t>Strong Internet Names (SINs) bring together concepts introduced in the use of Strong Names introduced in the .Net security framework, fingerprints as used in OpenPGP and security policy description.</t>
<t>Incorporating a fingerprint of a root of trust into an identifier produces an identifier whose interpretation is objective and does not depend on subjective assumptions as to whether a root of trust is trustworthy or not.</t>
<t>Since the SIN only includes the fingerprint of the root of trust, rather than the root of trust itself, the process of interpretation will of course require a means of retrieving the additional information. </t>
</section>
<section title="Overview" anchor="Section_2">
<t>A SIN is an Internet Identifier that contains a fingerprint of a root of trust that may be used to verify the interpretation of the identifier. This section describes the manner in which SINs are used. The following section describes their construction using Uniform Data Fingerprints [draft-hallambaker-udf-05]</t>
<t>For example, Example Inc holds the domain name example.com and has deployed a private CA whose root of trust is a PKIX certificate with the UDF fingerprint MB2GK-6DUF5-YGYYL-JNY5E-RWSHZ.</t>
<t>Alice is an employee of Example Inc., she uses three email addresses:</t>
<t><list style="hanging">
<t><list style="hanging">
<t hangText="alice@example.com">A regular email address (not a SIN).</t>
<t hangText="alice@mm--mb2gk-6duf5-ygyyl-jny5e-rwshz.example.com">A strong email address that is backwards compatible.</t>
<t hangText="alice@example.com.mm--mb2gk-6duf5-ygyyl-jny5e-rwshz">A strong email address that is backwards incompatible.</t>
</list></t>
</list></t>
<t>All three forms of the address are valid RFC822 addresses and may be used in a legacy email client, stored in an address book application, etc. But the ability of a legacy client to make use of the address differs. Addresses of the first type may always be used. Addresses of the second type may only be used if an appropriate MX record is provisioned. Addresses of the third type will always fail unless the resolver understands that it is a SIN requiring special processing.</t>
<t>When specified as the destination address in a Mail User Application (MUA), these addresses have the following interpretations:</t>
<t><list style="hanging">
<t><list style="hanging">
<t hangText="alice@example.com">Send mail to Alice without requiring security enhancements.</t>
<t hangText="alice@mm--mb2gk-6duf5-ygyyl-jny5e-rwshz.example.com">Send mail to Alice. If the MUA is SIN-Aware, it MUST resolve the security policy specified by the fingerprint and apply security enhancements as mandated by that policy.</t>
<t hangText="alice@example.com.mm--mb2gk-6duf5-ygyyl-jny5e-rwshz">Only send mail to Alice if the MUA is SIN-Aware, it MUST resolve the security policy specified by the fingerprint and apply security enhancements as mandated by that policy.</t>
</list></t>
</list></t>
<t>These rules allow Bob to send email to Alice with either 'best effort' security or mandatory security as the circumstances demand.</t>
<section title="Resolution" anchor="Section_2_1">
<t>Since a SIN only contains the fingerprint of a root of trust rather than the root of trust itself, a mechanism is required to resolve the root of trust from the fingerprint. The mechanism by which this is achieved is outside the scope of this document.</t>
<t>The Mathematical Mesh is an infrastructure that is designed to resolve fingerprints to policy. But it is not necessarily the case that an entirely new infrastructure is required. The Mesh architecture was conceived as a means of achieving resolution of a SIN at a very granular level. In the Mesh, every user is their own personal root of trust and decides which resources and trust providers to delegate decisions to.</t>
<t>For cases in which we do not require resolution of security policy with resolution finer than a DNS domain, the DNS may be used for resolution using the existing CERT record [RFC4398]</t>
</section>
<section title="Implicit Security Policy" anchor="Section_2_2">
<t>A security policy may be implicit or explicit depending on the root of trust referenced and the context in which it is used.</t>
<t>Since many Internet applications are already designed to make use of a PKIX based trust infrastructure, the fingerprint of a PKIX root of trust provides sufficient information to deduce an appropriate security policy in many instances. For example:</t>
<t><list style="hanging">
<t><list style="hanging">
<t hangText="https://mb2gk-6duf5-ygyyl-jny5e-rwshz.example.com/">Connect to example.com using a TLS connection with a certificate that is valid in a chain of trust that contains a certificate with the fingerprint mb2gk.</t>
<t hangText="IMAP Server: mb2gk-6duf5-ygyyl-jny5e-rwshz.example.com">Connect to the IMAP server example.com over a TLS connection with a certificate that is valid in a chain of trust that contains a certificate with the fingerprint mb2gk.</t>
<t hangText="mailto:alice@example.com.mm--mb2gk-6duf5-ygyyl-jny5e-rwshz">Encrypt mail messages using S/MIME using an S/MIME certificate that is valid in a chain of trust that contains a certificate with the fingerprint mb2gk.</t>
</list></t>
</list></t>
</section>
<section title="Explicit Security Policy" anchor="Section_2_3">
<t>While the implicit security policy model is sufficient for some purposes, it is less than ideal. An explicit security policy language permits much more detailed policy descriptions and links to resources that allow the policy to be realized.</t>
<t>A comprehensive security policy for Example Inc. should contain:</t>
<t><list style="symbols">
<t><list style="symbols">
<t>The public key for the DNSSEC root of trust for example.com</t>
<t>The public key for the DNSSEC root of trust for the DNS root</t>
<t>The roots of trust for TLS, S/MIME, etc.</t>
<t>The set of WebPKI trust roots to be trusted by Web browsers.</t>
<t>The security enhancements (S/MIME, OpenPGP) to be applied to messages.</t>
<t>Security requirements for specific services (e.g. must use TLS for inbound SMTP)</t>
</list></t>
</list></t>
<t>Security policy may also be specified for particular applications. For example, an email security policy for an individual user might specify:</t>
<t><list style="symbols">
<t><list style="symbols">
<t>Message security format (OpenPGP, S/MIME) and encryption key(s) </t>
<t>Authentication requirement(s)</t>
<t>Content restrictions (e.g. no executable attachments)</t>
</list></t>
</list></t>
<t>It is very likely that to mitigate abuse a user would specify separate security policies for known and unknown senders so that use of end-to-end messaging, transfer of executable attachments, etc. are restricted to authorized senders.</t>
<t>One option for expressing explicit security policy is to encode the information in the DNS. Another, likely to be more satisfactory is to design a language for describing security policy.</t>
</section>
</section>
<section title="Specification" anchor="Section_3">
<t>The specification consists of three parts, the description of the fingerprint format itself, the means of encoding fingerprints within DNS names and the means of describing the security policy.</t>
<section title="The UDF Format" anchor="Section_3_1">
<t>The Uniform Data Fingerprint (UDF) format was designed to provide common format for representing fingerprints of data objects formed using a cryptographic digest function such as SHA-2 that was easier on the eye than existing URI schemes such as ni. A UDF fingerprint is formed using Base32 with optional digit separators to improve readability. The following is an example of a UDF:</t>
<t>mb2gk-6duf5-ygyyl-jny5e-rwshz-sv75j</t>
<t>Unlike traditional fingerprints calculated from the digest of the data itself, a UDF is a strong function of both the referenced data and the IANA content type.</t>
<t>Fingerprint = &lt;Version-ID&gt; + H (&lt;Content-ID&gt; + ?:? + H(&lt;Data&gt;))</t>
<t>This approach provides semantic separation between domains. This is necessary to defeat substitution attacks such as presenting an artfully constructed PKIX certificate in a context where a JSON data structure is expected.</t>
<t>The Version-ID parameter specifies both the digest function and the method of application. Version-IDs are currently defined for SHA-2-512 and SHA-3-512. The values of these code points have been intentionally chosen to cause the first digit to be either an M (Merkle-Damgard) or an S (Sponge).</t>
<t>The specification allows for fingerprint compression in the case that the leading 25, 40, 50 or 55 bits are all zero. This allows a fingerprint of a public key represented in 20 characters (120 bits) to present the same work factor to the attacker as a 25 character fingerprint but at the cost of accepting a 2^25 increase in key generation difficulty.</t>
</section>
<section title="Precision" anchor="Section_3_2">
<t>A UDF fingerprint may be specified at any level of precision with the proviso that the work factor of a fingerprint must never be less than 2^117 operations. The precision of a fingerprint may be reduced by simply truncating the text presentation. </t>
<t>Since verification of a fingerprint requires the verifier to compute the full SHA-2-512 hash value, an application may 'strengthen' the fingerprint by storing it with higher precision (provided this does not cause a field length limit to be exceeded. </t>
<t>For example, to configure her outbound email address, alice enters the following as her email address:</t>
<t>mm--mb2gk-6duf5-ygyyl-jny5e-rwshz.example.com</t>
<t>The client resolves and verifies the root of trust and records the following in the configuration file:</t>
<t>Service: example.com</t>
<t>Trust-root: mb2gk-6duf5-ygyyl-jny5e-rwshz-sv75j-c4ozq-5gin2</t>
<t>This presents a work factor of 2^192 for subsequent interactions while only requiring the user to type enough digits for a 2^117 .</t>
</section>
<section title="UDF Strong Labels" anchor="Section_3_3">
<t>A Strong Internet Name is a DNS name in which one of the labels is a prefixed UDF fingerprint of a document describing the security policy governing interpretation of the name. </t>
<t>For example, we may form a strong internet name from the fingerprint above as follows:</t>
<t>mm--mb2gk-6duf5-ygyyl-jny5e-rwshz.example.com</t>
<t>example.com.mm--.mb2gk-6duf5-ygyyl-jny5e-rwshz</t>
<t>The use of a prefix of the form xx-- to identify a DNS label with a special interpretation was introduced to support internationalized DNS names. The MM?prefix is proposed as Strong Internet Names were originally developed as part of the Mathematical Mesh which builds on and extends the capabilities of strong names.</t>
<t>The placement of the UDF entry in the string has no effect on semantics but does affect resolution. In the first strong name, the fingerprint appears at the leftmost of the name allowing it to be resolved by any Internet application (provided the necessary DNS records are provisioned). In the second case, the fingerprint appears as the root element. This means that the name cannot be resolved by an application unless either the application or the DNS resolution service it uses understands that the name is a SIN.</t>
</section>
</section>
<section title="Implementation" anchor="Section_4">
<t>A prototype implementation is currently being built to make use of SINs to secure email and interactions by means of a proxy.</t>
<t>In the email implementation, the proxy is configured to apply security enhancements to the outbound email (SUBMIT) service. The proxy recognizes messages that are sent to mail addresses that contain a SIN, and attempts to retrieve and apply the corresponding security policy.</t>
<t/>
<t/>
</section>
</middle>
<back>
<references title="Normative References">
<reference anchor="RFC4398">
<front>
<title>Storing Certificates in the Domain Name System (DNS)</title>
<author fullname="S. Josefsson" initials="S." surname="Josefsson">
<organization/>
<address>
</address>
</author>
<date month="March" year="2006"/>
</front>
<seriesInfo name="RFC" value="4398"/>
<seriesInfo name="DOI" value="10.17487/RFC4398"/>
</reference>
<reference anchor="draft-hallambaker-udf-05">
<front>
<title>[Reference Not Found!]</title>
<author initials="" surname="">
<organization/>
<address>
</address>
</author>
<date/>
</front>
</reference>
</references>
</back>
</rfc>
